#!/usr/bin/env bash

# 配列の宣言
POSITIONAL_ARGS=()
# $0 スクリプト名
# $! 引数の数
# $@ 全ての引数（forループで分割処理される）
# $* 全ての引数（一つの文字列として）
# ${パラメータ:オフセット:長さ} 文字列から一部を切り出す。長さがマイナスだと
# 最後からその長さ分戻った所までを切り出す。
while [[ $# -gt 0 ]]; do
    case $1 in
        #//// ここにオプションを追加していきます ////
        -s|--search-path)  SEARCH_PATH="$2"; shift; shift;;
        -s=*|--search-path=*) ARG="$2";  SEARCH_PATH="${ARG#*=}"; unset ARG; shift;;
        --flag)  FLAG="YES"; shift;;  #// Without value
        --help)  HELP="YES"; shift;;  #// Without value
        # += 配列、変数に値を追加する
        --) shift;  POSITIONAL_ARGS+=("$@"); set --;;
        --*) echo "[ERROR] Unknown option $1"; exit 1;;
        -*) #// Multiple short name options. e.g.-fh
            OPTIONS=$1
            for (( i=1; i<${#OPTIONS}; i++ )); do
                case "-${OPTIONS:$i:1}" in
                    #//// ここにフラグの ショート オプション を追加していきます ////
                    -f)  FLAG="YES";;
                    -h)  HELP="YES";;
                    *) echo "[ERROR] Unknown option -${OPTIONS:$i:1}"; exit 1;;
                esac
            done
            unset OPTIONS; shift;;
        *) POSITIONAL_ARGS+=("$1"); shift;;
    esac
done
# set -- aaa bbb ccc, 位置引数を上書きする。
# [@]配列の全ての値を参照
set -- "${POSITIONAL_ARGS[@]}"  #// set $1, $2, ...
unset POSITIONAL_ARGS

echo "\$SEARCH_PATH = \"${SEARCH_PATH}\""
echo "\$FLAG        = \"${FLAG}\""
echo "\$HELP        = \"${HELP}\""
echo "\$1           = \"$1\""
echo "\$2           = \"$2\""
